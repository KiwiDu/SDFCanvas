{"map":"{\"version\":3,\"sources\":[\"webpack/bootstrap\",\"C:\\\\Users\\\\kiwid\\\\Documents\\\\FrontendPlayground\\\\SDFCanvas\\\\ts\\\\shapes.ts\",\"C:\\\\Users\\\\kiwid\\\\Documents\\\\FrontendPlayground\\\\SDFCanvas\\\\ts\\\\geomath.ts\",\"C:\\\\Users\\\\kiwid\\\\Documents\\\\FrontendPlayground\\\\SDFCanvas\\\\ts\\\\index.ts\"],\"names\":[\"installedModules\",\"__webpack_require__\",\"moduleId\",\"exports\",\"module\",\"i\",\"l\",\"modules\",\"call\",\"m\",\"c\",\"d\",\"name\",\"getter\",\"o\",\"Object\",\"defineProperty\",\"enumerable\",\"get\",\"r\",\"Symbol\",\"toStringTag\",\"value\",\"t\",\"mode\",\"__esModule\",\"ns\",\"create\",\"key\",\"bind\",\"n\",\"object\",\"property\",\"prototype\",\"hasOwnProperty\",\"p\",\"s\",\"shapes_Segment\",\"Shape\",\"[object Object]\",\"a\",\"b\",\"super\",\"this\",\"_b\",\"_way\",\"Dot\",\"toDot\",\"op\",\"x\",\"y\",\"opr\",\"dis\",\"dis1_sqr\",\"dis_sqr\",\"dis2_sqr\",\"len_sqr\",\"Math\",\"sqrt\",\"min\",\"abs\",\"shapes_Line\",\"_dd\",\"sdf\",\"A\",\"B\",\"C\",\"takein\",\"len\",\"dotProduct\",\"_da\",\"Vector\",\"form\",\"k\",\"_kb\",\"shapes_Capsule\",\"segment\",\"radius\",\"dx\",\"dy\",\"id\",\"origin\",\"_e\",\"lin_reg\",\"x1\",\"x2\",\"val\",\"max\",\"ts_Coordinate\",\"ctx\",\"width\",\"height\",\"w\",\"h\",\"fillStyle\",\"fillRect\",\"floor\",\"weight\",\"length\",\"step\",\"absX\",\"absY\",\"half_w\",\"half_h\",\"relX\",\"relY\",\"shapes\",\"data\",\"getImageData\",\"pixels\",\"shape\",\"toRelXY\",\"ret\",\"blend_pixel\",\"Color\",\"putImageData\",\"axis\",\"Uint8ClampedArray\",\"fill_pixel\",\"color\",\"R\",\"G\",\"alpha\",\"console\",\"log\",\"painter\",\"cvs_id\",\"cvs\",\"document\",\"getElementById\",\"getContext\",\"imageSmoothingEnabled\",\"init_canvas\",\"list\",\"push\",\"addEventListener\",\"url\",\"toDataURL\",\"save\",\"renderSDF\",\"main\"],\"mappings\":\"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\",\"sourcesContent\":[\" \\t// The module cache\\n \\tvar installedModules = {};\\n\\n \\t// The require function\\n \\tfunction __webpack_require__(moduleId) {\\n\\n \\t\\t// Check if module is in cache\\n \\t\\tif(installedModules[moduleId]) {\\n \\t\\t\\treturn installedModules[moduleId].exports;\\n \\t\\t}\\n \\t\\t// Create a new module (and put it into the cache)\\n \\t\\tvar module = installedModules[moduleId] = {\\n \\t\\t\\ti: moduleId,\\n \\t\\t\\tl: false,\\n \\t\\t\\texports: {}\\n \\t\\t};\\n\\n \\t\\t// Execute the module function\\n \\t\\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\\n\\n \\t\\t// Flag the module as loaded\\n \\t\\tmodule.l = true;\\n\\n \\t\\t// Return the exports of the module\\n \\t\\treturn module.exports;\\n \\t}\\n\\n\\n \\t// expose the modules object (__webpack_modules__)\\n \\t__webpack_require__.m = modules;\\n\\n \\t// expose the module cache\\n \\t__webpack_require__.c = installedModules;\\n\\n \\t// define getter function for harmony exports\\n \\t__webpack_require__.d = function(exports, name, getter) {\\n \\t\\tif(!__webpack_require__.o(exports, name)) {\\n \\t\\t\\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\\n \\t\\t}\\n \\t};\\n\\n \\t// define __esModule on exports\\n \\t__webpack_require__.r = function(exports) {\\n \\t\\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\\n \\t\\t\\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\\n \\t\\t}\\n \\t\\tObject.defineProperty(exports, '__esModule', { value: true });\\n \\t};\\n\\n \\t// create a fake namespace object\\n \\t// mode & 1: value is a module id, require it\\n \\t// mode & 2: merge all properties of value into the ns\\n \\t// mode & 4: return value when already ns object\\n \\t// mode & 8|1: behave like require\\n \\t__webpack_require__.t = function(value, mode) {\\n \\t\\tif(mode & 1) value = __webpack_require__(value);\\n \\t\\tif(mode & 8) return value;\\n \\t\\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\\n \\t\\tvar ns = Object.create(null);\\n \\t\\t__webpack_require__.r(ns);\\n \\t\\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\\n \\t\\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\\n \\t\\treturn ns;\\n \\t};\\n\\n \\t// getDefaultExport function for compatibility with non-harmony modules\\n \\t__webpack_require__.n = function(module) {\\n \\t\\tvar getter = module && module.__esModule ?\\n \\t\\t\\tfunction getDefault() { return module['default']; } :\\n \\t\\t\\tfunction getModuleExports() { return module; };\\n \\t\\t__webpack_require__.d(getter, 'a', getter);\\n \\t\\treturn getter;\\n \\t};\\n\\n \\t// Object.prototype.hasOwnProperty.call\\n \\t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\\n\\n \\t// __webpack_public_path__\\n \\t__webpack_require__.p = \\\"\\\";\\n\\n\\n \\t// Load entry module and return exports\\n \\treturn __webpack_require__(__webpack_require__.s = 0);\\n\",\"import {Shape,Transformation,Pair,Dot,Vector} from './geomath'\\r\\nimport {dis,dis_sqr,dotProduct,len,opr} from './geomath'\\r\\nexport {Line, Segment,Capsule,Circle}\\r\\n\\r\\n//fundamental\\r\\nclass Segment extends Shape{\\r\\n    constructor(public readonly a : Dot, public readonly b : Dot){super('Segment')}\\r\\n\\r\\n    form(_b : Dot, _way : Vector){\\r\\n        return new Segment(_b, Dot.toDot( opr(_b, _way, (a,b)=>a+b ) )  )\\r\\n    }\\r\\n\\r\\n    length() {\\r\\n        return dis(this.a,this.b)\\r\\n    }\\r\\n\\r\\n    sdf(d : Dot){\\r\\n        let dis1_sqr = dis_sqr(d,this.a)\\r\\n        let dis2_sqr = dis_sqr(d,this.b)\\r\\n        let len_sqr = dis_sqr(this.a,this.b)\\r\\n        let cos_val = ( dis1_sqr - dis2_sqr + len_sqr ) * ( dis2_sqr - dis1_sqr + len_sqr )\\r\\n        if(cos_val <= 0){\\r\\n            //Dun4 jiao3 san1 jiao3 xing2\\r\\n            return Math.sqrt(Math.min(dis1_sqr,dis2_sqr))\\r\\n        }else{\\r\\n            return Math.abs(Line._dd(this.a,this.b).sdf(d))\\r\\n        }\\r\\n    }\\r\\n}\\r\\n\\r\\nclass Line extends Shape{\\r\\n    constructor(public readonly A : number, \\r\\n                public readonly B : number, \\r\\n                public readonly C : number){super('Line')}\\r\\n\\r\\n    sdf(d : Dot) : number{\\r\\n        return this.takein(d) / len({x : this.A, y : this.B})\\r\\n    }\\r\\n\\r\\n    takein(d : Dot){\\r\\n        return this.A * d.x + this.B * d.y + this.C\\r\\n    }\\r\\n\\r\\n    static _dn(d : Dot, n : Vector) : Line{\\r\\n        //d : (m,n) , n : (a,b) , l : a(x-m)+b(y-n)=0\\r\\n        return new Line(n.x, n.y, -dotProduct(d,n))\\r\\n    }\\r\\n\\r\\n    static _da(d : Dot, a : Vector) : Line{\\r\\n        //d : (m,n) , a : (a,b) , l : (x-m) / a = (y-n) / b\\r\\n        return new Line(-a.y, a.x, -dotProduct(d,a))\\r\\n    }\\r\\n\\r\\n    static _dd(a : Dot, b : Dot) : Line{\\r\\n        return this._da( a, Vector.form(a, b) )\\r\\n    }\\r\\n\\r\\n    static _dk(d : Dot, k : number) : Line{\\r\\n        //d : (m,n) , k , y - n = k * ( x - m )\\r\\n        return this._kb(k, -k * d.y + d.x)\\r\\n        //equivalent : new Line(1, -k, m * k - n)\\r\\n    }\\r\\n\\r\\n    static _kb(k : number,b : number) : Line{\\r\\n        //k , b , y = k * x + b\\r\\n        return new Line(1, -k, b)\\r\\n    }\\r\\n}\\r\\n\\r\\n//derivations\\r\\nclass Capsule extends Shape{\\r\\n    constructor(public readonly segment : Segment,\\r\\n                public readonly radius : number){super('Capsule')}\\r\\n\\r\\n    sdf(d:Dot){\\r\\n        return this.segment.sdf(d) - this.radius\\r\\n    }\\r\\n}\\r\\n\\r\\nclass Circle extends Shape{\\r\\n    constructor(public readonly center : Dot,public readonly radius : number){super('Circle')}\\r\\n\\r\\n    sdf(d:Dot){\\r\\n        return this.center.sdf(d) - this.radius\\r\\n    }\\r\\n}\\r\\n\\r\\n/*\\r\\nfunction ngon(n,r){\\r\\n    let pi = 3.14\\r\\n    return (x,y)=>{\\r\\n        if(n<=2)\\r\\n            return 1\\r\\n        const angle = Math.atan2(y,x);\\r\\n        const div = 2 * pi / n;\\r\\n        let i = Math.floor(angle/div)\\r\\n        let j = i + 0.5\\r\\n        const mpr = r * Math.cos(div/2)\\r\\n        let mp = new Dot(mpr * Math.cos(j * div), mpr * Math.sin(j * div))\\r\\n        let line = Line._dn(mp, Vector.toVector(mp))\\r\\n        return line.sdf(new Dot(x,y))\\r\\n    }\\r\\n}\\r\\n*/\\r\\n\",\"import {Matrix} from './matrix'\\r\\nexport {Transformation,Pair,Dot,Vector,Shape}\\r\\nexport {dotProduct,dis,dis_sqr,len,opr}\\r\\n\\r\\nexport {Line,Segment,Capsule,Circle} from './shapes'\\r\\n\\r\\ninterface Pair{\\r\\n    x : number\\r\\n    y : number\\r\\n}\\r\\n\\r\\nfunction toPair(p : [number,number]) : Pair{\\r\\n    return {x : p[0], y : p[1]}\\r\\n}\\r\\n\\r\\ninterface Transformation{\\r\\n    transformMatrix : Matrix\\r\\n    transform(m : Matrix)\\r\\n    pos() : Dot\\r\\n}\\r\\n\\r\\nfunction len(p : Pair){\\r\\n    return Math.sqrt(p.x * p.x + p.y * p.y)\\r\\n}\\r\\n\\r\\nfunction dotProduct(a : Pair, b : Pair){\\r\\n    return a.x * b.x + a.y * b.y\\r\\n}\\r\\n\\r\\nfunction dis_sqr(a : Pair, b : Pair){\\r\\n    let dx = a.x - b.x\\r\\n    let dy = a.y - b.y\\r\\n    return (dx * dx + dy * dy)\\r\\n}\\r\\n\\r\\n\\r\\nfunction dis (a : Pair, b : Pair){\\r\\n    return Math.sqrt(dis_sqr(a,b))\\r\\n}\\r\\n\\r\\nfunction opr(a : Pair, b : Pair, op : (a:number,b:number) => number){\\r\\n    return {x : op(a.x,b.x), y : op(a.y,b.y)}\\r\\n}\\r\\n\\r\\nfunction transform(m : Matrix){\\r\\n    return m.inverseMatrix()\\r\\n}\\r\\n\\r\\ninterface IShape{\\r\\n    sdf(d:Dot):number\\r\\n}\\r\\n\\r\\nabstract class Shape implements IShape{\\r\\n    constructor(public readonly id : string){}\\r\\n    \\r\\n    abstract sdf(d:Dot) : number\\r\\n    /*asdf(d : [number,number] ) : number{\\r\\n        return this.sdf(new Dot(d[0], d[1]))\\r\\n    }*/\\r\\n}\\r\\n\\r\\nclass Dot extends Shape{\\r\\n    static origin : Dot = new Dot(0,0)\\r\\n    \\r\\n    constructor(public readonly x : number, public readonly y : number){super('Dot')}\\r\\n\\r\\n    sdf(d : Dot) : number{\\r\\n        return dis(this, d)\\r\\n    }\\r\\n\\r\\n    center() : Dot{\\r\\n        return this\\r\\n    }\\r\\n\\r\\n    static toDot(p : Pair){\\r\\n        return new Dot(p.x,p.y)\\r\\n    }\\r\\n}\\r\\n\\r\\nclass Vector{\\r\\n\\r\\n    constructor(public readonly x : number, public readonly y : number){}\\r\\n    \\r\\n    static form(_b : Dot, _e : Dot) : Vector{\\r\\n        let x = _e.x - _b.x\\r\\n        let y = _e.y - _b.y\\r\\n        return new Vector(x,y)\\r\\n    }\\r\\n\\r\\n    length() : number{\\r\\n        return len(this)\\r\\n    }\\r\\n\\r\\n    static toVector(p:Pair):Vector{\\r\\n        return new Vector(p.x,p.y)\\r\\n    }\\r\\n}\\r\\n\",\"import * as Geo from './geomath'\\r\\n//export { main }\\r\\n\\r\\ntype Canvas = HTMLCanvasElement\\r\\ntype Context2D = CanvasRenderingContext2D\\r\\ntype Text = HTMLTextAreaElement\\r\\n\\r\\n//Regularize the coordinate \\r\\n\\t\\t\\t\\t/*\\r\\n\\t\\t\\t\\t@----------->x (0,width)\\t  => \\t  \\t    y (-1,1)\\r\\n\\t\\t\\t\\t|\\t\\t\\t\\t\\t\\t\\t  \\t    \\t\\t^\\r\\n\\t\\t\\t\\t|\\t\\t\\t\\t\\t\\t\\t \\t \\t        |\\r\\n\\t\\t\\t\\t|\\t\\t\\t\\t\\t\\t\\t\\t \\t\\t   \\t|\\r\\n\\t\\t\\t\\t|\\t\\t\\t\\t\\t\\t\\t\\t \\t--------@------>x (-1,1)\\r\\n\\t\\t\\t\\tv\\t\\t\\t\\t\\t\\t\\t\\t \\t \\t    |\\r\\n\\t\\t\\t\\ty (0,height)\\t\\t\\t\\t\\t \\t   \\t\\t|\\r\\n\\t\\t\\t\\t*/\\r\\n\\r\\nfunction init_canvas(cvs_id : string) : Coordinate{\\r\\n\\tlet cvs : Canvas = <Canvas>document.getElementById(cvs_id)\\r\\n\\tconst w = cvs.width,\\r\\n\\t\\t  h = cvs.height\\r\\n\\tlet ctx : Context2D = cvs.getContext('2d')!\\r\\n\\tctx.imageSmoothingEnabled = false\\t\\t\\t//pixel level rendering\\r\\n\\tlet data = ctx.getImageData(0,0,w,h)\\r\\n\\tlet pixels = data.data\\r\\n\\tlet i = 0\\t\\t\\t//pointer counting the pixels\\r\\n\\t//let cmd : string = (<Text>document.getElementById('cmd')).value\\r\\n\\t\\r\\n\\treturn new Coordinate(ctx,w,h)\\r\\n}\\r\\n\\r\\nfunction lin_reg(x1,x2,val){\\r\\n    val=(val-x1)/(x2-x1)\\r\\n    val=Math.min(val,1)\\r\\n    val=Math.max(val,0)\\r\\n    return val\\r\\n}\\r\\n\\r\\nclass Coordinate{\\r\\n\\tconstructor(private ctx : Context2D, \\r\\n\\t\\t\\t\\tpublic readonly width : number, \\r\\n\\t\\t\\t\\tpublic readonly height : number){}\\r\\n\\r\\n\\tprivate axis(){\\r\\n\\t\\tconst [w, h] = [this.width, this.height]\\r\\n\\r\\n\\t\\tthis.ctx.fillStyle ='#e51c23'\\r\\n\\t\\tthis.ctx.fillRect(Math.floor(w*0.5)-1, 0, 2, h)  //y\\r\\n\\t\\tthis.ctx.fillRect(0, Math.floor(h*0.5)-1, w, 2)  //x\\r\\n\\t\\t\\r\\n\\t\\tconst [weight,length,step]=[1,0.005,20]\\r\\n\\t\\tfor(let i = 0; i <= step; i++){\\r\\n\\t\\t\\tthis.ctx.fillRect(Math.floor(w*(0.5-length)), Math.floor(i*(h/step)-weight/2), \\r\\n\\t\\t\\t\\t\\t\\t\\tMath.floor(w*2*length), weight)  //y\\r\\n\\t\\t\\tthis.ctx.fillRect(Math.floor(i*(w/step)-weight/2), Math.floor(h*(0.5-length)), \\r\\n\\t\\t\\t\\t\\t\\t\\tweight, Math.floor(h*2*length))  //x\\r\\n\\t\\t}\\r\\n\\t}\\r\\n\\r\\n\\tprivate toRelXY(absX : number, absY : number){\\r\\n\\t\\tconst [half_w , half_h] = [this.width * 0.5, this.height * 0.5]\\r\\n\\t\\treturn [(absX - half_w) / half_w, (half_h - absY) / half_h]\\r\\n\\t}\\r\\n\\r\\n\\tprivate toAbsXY(relX : number, relY : number){\\r\\n\\t\\tconst [half_w , half_h] = [this.width * 0.5, this.height * 0.5]\\r\\n\\t\\treturn [(relX * half_w) + half_w, half_h - (half_h * relY)]\\r\\n\\t}\\r\\n\\r\\n\\trenderSDF(shapes : Geo.Shape[]){\\r\\n\\t\\tconst [w, h] = [this.width, this.height]\\r\\n\\r\\n\\t\\tlet i : number = 0\\r\\n\\r\\n\\t\\tlet data = this.ctx.getImageData(0,0,w,h)\\r\\n\\t\\tlet pixels = data.data\\r\\n\\t\\tfor(let shape of shapes){\\r\\n\\t\\t\\tfor(let absY = 0; absY < h; absY++){\\r\\n\\t\\t\\t\\tfor(let absX = 0; absX < w; absX++){\\r\\n\\t\\t\\t\\t\\tlet [x,y] = this.toRelXY(absX,absY)//Regularize the coordinate \\r\\n\\t\\t\\t\\t\\tlet ret = shape.sdf(new Geo.Dot(x,y))//calculate\\r\\n\\t\\t\\t\\t\\tret = lin_reg(-0.001,0.001,ret) * 255//fill the pixel by R G B A\\r\\n\\t\\t\\t\\t\\tpixels.blend_pixel(i, new Color(ret,ret,ret,255))//Accumulate the pointer\\r\\n\\t\\t\\t\\t\\ti++\\r\\n\\t\\t\\t\\t}\\r\\n\\t\\t\\t}\\r\\n\\t\\t\\tthis.ctx.putImageData(data,0,0)\\r\\n\\t\\t}\\r\\n\\t\\tthis.axis()\\r\\n\\t}\\r\\n}\\r\\n\\r\\ndeclare global {\\r\\n\\tinterface Uint8ClampedArray{\\r\\n\\t\\tfill_pixel(index : number, color : Color) : void\\r\\n\\t\\tblend_pixel(index : number, color : Color) : void\\r\\n\\t}\\r\\n}\\r\\n\\r\\nUint8ClampedArray.prototype.fill_pixel = function (i : number, color : Color) : void{\\r\\n\\tthis[4*i]   = color.R\\r\\n\\tthis[4*i+1] = color.G\\r\\n\\tthis[4*i+2] = color.B\\r\\n\\tthis[4*i+3] = color.A\\r\\n}\\r\\n\\r\\nUint8ClampedArray.prototype.blend_pixel = function (i :number, color : Color) : void{\\r\\n\\tlet alpha = color.A / 255.0\\r\\n\\tthis[4*i]   += color.R * alpha\\r\\n\\tthis[4*i+1] += color.G * alpha\\r\\n\\tthis[4*i+2] += color.B * alpha\\r\\n\\tthis[4*i+3] = 255\\r\\n}\\r\\n\\r\\nclass Color{\\r\\n\\tconstructor(public readonly R:number,\\r\\n\\t\\t\\t\\tpublic readonly G:number,\\r\\n\\t\\t\\t\\tpublic readonly B:number,\\r\\n\\t\\t\\t\\tpublic readonly A:number){}\\r\\n}\\r\\n\\r\\nfunction save(cvs_id : string) : void{\\r\\n\\tlet cvs = <HTMLCanvasElement>document.getElementById(cvs_id)\\r\\n\\tlet url = cvs.toDataURL()\\r\\n\\tconsole.log(url)\\r\\n}\\r\\n\\r\\nfunction main() {//the entry that register everything\\r\\n\\tconsole.log(\\\"loaded\\\")\\r\\n\\r\\n\\tlet painter=init_canvas('cvs')\\r\\n\\tlet sdf = new Geo.Capsule(new Geo.Segment(new Geo.Dot(0,0),new Geo.Dot(0.2,0.1)),0.1)//magic,hah!\\r\\n\\tlet list : Geo.Shape[]=[]\\r\\n\\tlist.push(sdf)\\r\\n\\tlet savebtn = document.getElementById('save')\\r\\n\\t\\r\\n\\tsavebtn!.addEventListener('click',()=>{\\r\\n\\t\\tsave('cvs')\\r\\n\\t})\\r\\n\\t\\r\\n\\tlet dobtn = document.getElementById('do')\\r\\n\\tdobtn!.addEventListener('click',()=>{\\r\\n\\t\\tpainter.renderSDF(list)\\r\\n\\t})\\r\\n\\t\\r\\n\\tpainter.renderSDF(list)\\r\\n\\r\\n\\t/* Unit test passed on 18/10/05\\r\\n\\tlet a = Matrix.rotate(1).multiplyMatrix(Matrix.translate(0.2,-0.3))\\r\\n\\t////a=Matrix.translate(10,-20)\\r\\n\\tconsole.log('ori:\\\\n'+a)\\r\\n\\t////console.log('multi&divide:\\\\n'+a.multiplyNumber(2)+'\\\\n\\\\n'+a.divideByNumber(2))\\r\\n\\tconsole.log('inverse:\\\\n'+a.inverseMatrix())\\r\\n\\tconsole.log('invertwice:\\\\n'+a.inverseMatrix().inverseMatrix())\\r\\n\\tconsole.log('product:\\\\n'+a.multiplyMatrix(a.inverseMatrix()) )\\r\\n\\t*/\\r\\n}\\r\\n\\r\\nmain()\\r\\n//console.log(\\\"jsloaded\\\")\"]}","code":"!function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(t,\"__esModule\",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&\"object\"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,\"default\",{enumerable:!0,value:t}),2&e&&\"string\"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,\"a\",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p=\"\",n(n.s=0)}([function(t,e,n){\"use strict\";n.r(e);class r extends a{constructor(t,e){super(\"Segment\"),this.a=t,this.b=e}form(t,e){return new r(t,l.toDot(function(t,e,n){return{x:n(t.x,e.x),y:n(t.y,e.y)}}(t,e,(t,e)=>t+e)))}length(){return u(this.a,this.b)}sdf(t){let e=c(t,this.a),n=c(t,this.b),r=c(this.a,this.b);return(e-n+r)*(n-e+r)<=0?Math.sqrt(Math.min(e,n)):Math.abs(i._dd(this.a,this.b).sdf(t))}}class i extends a{constructor(t,e,n){super(\"Line\"),this.A=t,this.B=e,this.C=n}sdf(t){return this.takein(t)/o({x:this.A,y:this.B})}takein(t){return this.A*t.x+this.B*t.y+this.C}static _dn(t,e){return new i(e.x,e.y,-h(t,e))}static _da(t,e){return new i(-e.y,e.x,-h(t,e))}static _dd(t,e){return this._da(t,d.form(t,e))}static _dk(t,e){return this._kb(e,-e*t.y+t.x)}static _kb(t,e){return new i(1,-t,e)}}class s extends a{constructor(t,e){super(\"Capsule\"),this.segment=t,this.radius=e}sdf(t){return this.segment.sdf(t)-this.radius}}function o(t){return Math.sqrt(t.x*t.x+t.y*t.y)}function h(t,e){return t.x*e.x+t.y*e.y}function c(t,e){let n=t.x-e.x,r=t.y-e.y;return n*n+r*r}function u(t,e){return Math.sqrt(c(t,e))}class a{constructor(t){this.id=t}}class l extends a{constructor(t,e){super(\"Dot\"),this.x=t,this.y=e}sdf(t){return u(this,t)}center(){return this}static toDot(t){return new l(t.x,t.y)}}l.origin=new l(0,0);class d{constructor(t,e){this.x=t,this.y=e}static form(t,e){let n=e.x-t.x,r=e.y-t.y;return new d(n,r)}length(){return o(this)}static toVector(t){return new d(t.x,t.y)}}function f(t,e,n){return n=(n-t)/(e-t),n=Math.min(n,1),n=Math.max(n,0)}class x{constructor(t,e,n){this.ctx=t,this.width=e,this.height=n}axis(){const[t,e]=[this.width,this.height];this.ctx.fillStyle=\"#e51c23\",this.ctx.fillRect(Math.floor(.5*t)-1,0,2,e),this.ctx.fillRect(0,Math.floor(.5*e)-1,t,2);const[n,r,i]=[1,.005,20];for(let s=0;s<=i;s++)this.ctx.fillRect(Math.floor(t*(.5-r)),Math.floor(s*(e/i)-n/2),Math.floor(2*t*r),n),this.ctx.fillRect(Math.floor(s*(t/i)-n/2),Math.floor(e*(.5-r)),n,Math.floor(2*e*r))}toRelXY(t,e){const[n,r]=[.5*this.width,.5*this.height];return[(t-n)/n,(r-e)/r]}toAbsXY(t,e){const[n,r]=[.5*this.width,.5*this.height];return[t*n+n,r-r*e]}renderSDF(t){const[e,n]=[this.width,this.height];let r=0,i=this.ctx.getImageData(0,0,e,n),s=i.data;for(let o of t){for(let t=0;t<n;t++)for(let n=0;n<e;n++){let[e,i]=this.toRelXY(n,t),h=o.sdf(new l(e,i));h=255*f(-.001,.001,h),s.blend_pixel(r,new y(h,h,h,255)),r++}this.ctx.putImageData(i,0,0)}this.axis()}}Uint8ClampedArray.prototype.fill_pixel=function(t,e){this[4*t]=e.R,this[4*t+1]=e.G,this[4*t+2]=e.B,this[4*t+3]=e.A},Uint8ClampedArray.prototype.blend_pixel=function(t,e){let n=e.A/255;this[4*t]+=e.R*n,this[4*t+1]+=e.G*n,this[4*t+2]+=e.B*n,this[4*t+3]=255};class y{constructor(t,e,n,r){this.R=t,this.G=e,this.B=n,this.A=r}}!function(){console.log(\"loaded\");let t=function(t){let e=document.getElementById(t);const n=e.width,r=e.height;let i=e.getContext(\"2d\");return i.imageSmoothingEnabled=!1,i.getImageData(0,0,n,r).data,new x(i,n,r)}(\"cvs\"),e=new s(new r(new l(0,0),new l(.2,.1)),.1),n=[];n.push(e),document.getElementById(\"save\").addEventListener(\"click\",()=>{!function(t){let e=document.getElementById(t).toDataURL();console.log(e)}(\"cvs\")}),document.getElementById(\"do\").addEventListener(\"click\",()=>{t.renderSDF(n)}),t.renderSDF(n)}()}]);","extractedComments":[]}